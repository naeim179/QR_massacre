<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>QR Massacre â€” Challenge</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #020617;
      --card: #020617;
      --border: #1f2937;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.15);
      --radius-lg: 16px;
      --radius-full: 999px;
      --shadow: 0 0 40px rgba(15,23,42,0.9);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #0b1120 0, #020617 50%, #000 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 32px 12px 40px;
      color: var(--text);
    }
    .container { width: 100%; max-width: 900px; }

    header {
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      gap: 12px;
      align-items: center;
      flex-wrap: wrap;
    }
    .title-block h1 {
      font-size: 1.35rem;
      letter-spacing: .08em;
      text-transform: uppercase;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .logo-dot {
      width: 12px;
      height: 12px;
      border-radius: 999px;
      background: radial-gradient(circle, #38bdf8, #0ea5e9 40%, transparent 70%);
      box-shadow:
        0 0 12px rgba(56,189,248,0.9),
        0 0 30px rgba(56,189,248,0.8);
    }
    .subtitle {
      margin-top: 4px;
      font-size: .9rem;
      color: var(--muted);
    }
    .subtitle strong { color: var(--accent); }
    .subtitle-ar {
      margin-top: 2px;
      font-size: .85rem;
      color: var(--muted);
      direction: rtl;
      text-align: right;
    }
    .back-link {
      font-size: .86rem;
      text-decoration: none;
      color: var(--accent);
      border-radius: var(--radius-full);
      border: 1px solid rgba(148,163,184,0.4);
      padding: 6px 12px;
      background: rgba(15,23,42,.85);
      white-space: nowrap;
    }
    .back-link:hover { border-color: var(--accent); }

    .card {
      background: var(--card);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      padding: 16px 16px 18px;
      margin-bottom: 16px;
      position: relative;
      overflow: hidden;
    }
    .card::before {
      content: "";
      position: absolute;
      inset: -140px;
      background: conic-gradient(
        from 220deg,
        transparent 0,
        rgba(56, 189, 248, 0.16) 12%,
        transparent 32%,
        transparent 60%,
        rgba(56, 189, 248, 0.14) 72%,
        transparent 90%
      );
      opacity: 0.5;
      pointer-events: none;
    }
    .card-inner {
      position: relative;
      z-index: 1;
    }

    .badge-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      margin-bottom: 8px;
    }
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: .74rem;
      padding: 4px 10px;
      border-radius: var(--radius-full);
      border: 1px solid rgba(148,163,184,0.5);
      background: rgba(15,23,42,0.9);
      color: var(--muted);
    }
    .badge-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
    }
    .badge-level-beginner .badge-dot { background:#22c55e; }
    .badge-level-intermediate .badge-dot { background:#eab308; }
    .badge-level-advanced .badge-dot { background:#fb923c; }
    .badge-level-expert .badge-dot { background:#f97373; }

    h2 {
      font-size: 1.15rem;
      margin-bottom: 6px;
    }
    .slug {
      font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: .8rem;
      color: var(--muted);
      margin-bottom: 10px;
    }

    .intro {
      font-size: .9rem;
      color: var(--text);
      margin-bottom: 6px;
      line-height: 1.5;
    }
    .intro-ar {
      font-size: .86rem;
      color: var(--muted);
      margin-bottom: 10px;
      direction: rtl;
      text-align: right;
      line-height: 1.5;
    }

    .steps {
      margin-top: 4px;
      font-size: .86rem;
      color: var(--text);
      line-height: 1.5;
    }
    .steps ol {
      margin-left: 18px;
      margin-top: 4px;
    }
    .steps li { margin-bottom: 3px; }
    .steps-ar {
      margin-top: 6px;
      font-size: .84rem;
      color: var(--muted);
      direction: rtl;
      text-align: right;
      line-height: 1.6;
    }

    .sub-tag {
      font-size: .78rem;
      color: var(--accent);
      margin-bottom: 4px;
    }
    .sub-tag-ar {
      font-size: .78rem;
      color: var(--accent);
      direction: rtl;
      text-align: right;
      margin-bottom: 4px;
    }

    .reveal-btn {
      margin-top: 12px;
      border-radius: var(--radius-full);
      border: 1px solid rgba(148,163,184,0.7);
      padding: 9px 18px;
      font-size: .9rem;
      cursor: pointer;
      background: linear-gradient(135deg, #020617, #020617);
      color: var(--accent);
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .reveal-btn span.icon { font-size: .95rem; }
    .reveal-btn:hover {
      border-color: var(--accent);
      box-shadow:
        0 0 0 1px rgba(15,23,42,0.9),
        0 18px 35px rgba(8,47,73,0.95);
    }

    .qr-wrapper {
      margin-top: 14px;
      border-radius: 14px;
      border: 1px solid rgba(148,163,184,0.4);
      padding: 10px;
      background: radial-gradient(circle at top, #020617, #020617 60%, #000);
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      transition: transform .15s ease, box-shadow .15s ease, border-color .15s ease;
    }
    .qr-wrapper.visible {
      display: flex;
    }
    .qr-wrapper:hover {
      transform: translateY(-3px);
      border-color: var(--accent);
      box-shadow:
        0 0 0 1px rgba(15,23,42,0.9),
        0 22px 45px rgba(8,47,73,0.95);
    }
    .qr-wrapper img {
      max-width: 240px;
      width: 100%;
      height: auto;
      background: white;
      border-radius: 8px;
    }
    .qr-caption {
      font-size: .8rem;
      color: var(--muted);
      text-align: center;
    }
    .qr-caption strong { color: var(--accent); }
    .hint-tap {
      font-size: .78rem;
      color: var(--muted);
      margin-top: 2px;
      text-align: center;
      font-style: italic;
    }

    .details {
      display: none;
      margin-top: 12px;
      font-size: .88rem;
      color: var(--text);
      line-height: 1.6;
    }
    .details.visible {
      display: block;
    }
    .details code {
      background: rgba(15,23,42,0.8);
      padding: 2px 4px;
      border-radius: 4px;
      font-size: .82rem;
    }
    .details-ar {
      direction: rtl;
      text-align: right;
      font-size: .84rem;
      color: var(--muted);
      margin-top: 6px;
      line-height: 1.6;
    }

    .start-btn {
      margin-top: 10px;
      border-radius: var(--radius-full);
      border: none;
      padding: 8px 16px;
      font-size: .9rem;
      cursor: pointer;
      background: linear-gradient(135deg, #0ea5e9, #22c55e);
      color: #0b1120;
      font-weight: 600;
    }
    .start-btn:hover { filter: brightness(1.07); }

    .note {
      margin-top: 10px;
      font-size: .78rem;
      color: var(--muted);
    }

    .error-card {
      background: var(--card);
      border-radius: var(--radius-lg);
      border: 1px solid #991b1b;
      box-shadow: var(--shadow);
      padding: 18px;
      margin-top: 30px;
    }
    .error-title {
      font-size: 1rem;
      color: #fecaca;
      margin-bottom: 6px;
    }
    .error-text {
      font-size: .88rem;
      color: var(--muted);
      margin-bottom: 8px;
    }
    .error-link {
      font-size: .86rem;
      color: var(--accent);
      text-decoration: none;
    }

    @media (max-width: 768px) {
      body { padding-top: 20px; }
      header {
        flex-direction: column;
        align-items: flex-start;
        gap: 6px;
      }
      .subtitle-ar { font-size: .82rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="title-block">
        <h1>
          <span class="logo-dot"></span>
          QR Massacre â€” Challenge
        </h1>
        <p class="subtitle">
          Each idea card becomes a QR-powered SQL injection lab. Some challenges put the
          <strong>payload itself inside the QR</strong>, not just a clean URL.
        </p>
        <p class="subtitle-ar">
          ÙƒÙ„ ÙƒØ§Ø±Ø¯ ÙÙƒØ±Ø© ÙŠØªØ­ÙˆÙ‘Ù„ Ù„ØªØ­Ø¯Ù‘ÙŠ Ø¹Ù…Ù„ÙŠ Ù…Ø¨Ù†ÙŠ Ø¹Ù„Ù‰ <strong>QR + SQLi</strong>ØŒ ÙˆØ¨Ø¹Ø¶
          Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª ØªÙƒÙˆÙ† ÙÙŠÙ‡Ø§ <strong>Ø§Ù„Ø«ØºØ±Ø© Ù†ÙØ³Ù‡Ø§ Ù…Ø®Ø²Ù‘Ù†Ø© Ø¯Ø§Ø®Ù„ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù€ QR</strong>ØŒ Ù…Ø´ Ø¨Ø³ Ø±Ø§Ø¨Ø· Ø¹Ø§Ø¯ÙŠ.
        </p>
      </div>
      <a href="index.html" class="back-link">â† Back to ideas list</a>
    </header>

    <main id="main"></main>
  </div>

  <script>
    // --- helper functions ---
    function getIdFromUrl() {
      const params = new URLSearchParams(window.location.search);
      const idStr = params.get("id");
      const id = parseInt(idStr, 10);
      if (Number.isNaN(id) || id < 1 || id > 50) return null;
      return id;
    }

    function getLevel(id) {
      if (id >= 1 && id <= 10) return { key: "beginner", label: "Beginner" };
      if (id >= 11 && id <= 20) return { key: "intermediate", label: "Intermediate" };
      if (id >= 21 && id <= 35) return { key: "advanced", label: "Advanced" };
      return { key: "expert", label: "Expert" };
    }

    // --- per-challenge custom content (for 1â€“3 fully) ---
    const challengeData = {
      1: {
        subEn: "QR holds the raw SQL payload used as username.",
        subAr: "Ø§Ù„Ù€ QR ÙŠØ­ØªÙˆÙŠ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ù„Ù‰ Payload Ø­Ù‚Ù† SQL ÙŠÙØ³ØªØ®Ø¯Ù… ÙƒØ§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù….",
        introEn: `
          This lab simulates a login kiosk that reads a QR code and automatically fills the
          <strong>username</strong> field with the exact text from the QR. The backend blindly
          inserts that value inside a SQL WHERE clause.
        `,
        introAr: `
          Ù‡Ø°Ø§ Ø§Ù„Ù„Ø§Ø¨ ÙŠØ­Ø§ÙƒÙŠ Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ (kiosk) ÙŠÙ‚Ø±Ø£ ÙƒÙˆØ¯ <strong>QR</strong> ÙˆÙŠØ¶Ø¹ Ù…Ø­ØªÙˆØ§Ù‡
          Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ Ø­Ù‚Ù„ <strong>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</strong>. Ø§Ù„Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯ ÙŠØ«Ù‚ Ø¨Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙˆÙŠØ³ØªØ®Ø¯Ù…Ù‡ ÙƒÙ…Ø§ Ù‡Ùˆ
          Ø¯Ø§Ø®Ù„ Ø¬Ù…Ù„Ø© <strong>WHERE</strong> ÙÙŠ Ø§Ø³ØªØ¹Ù„Ø§Ù… SQL Ø¨Ø¯ÙˆÙ† Ø£ÙŠ ØªØ¹Ù‚ÙŠÙ….
        `,
        stepsEn: [
          "Reveal and scan the QR code below. Instead of a URL, youâ€™ll see a raw SQL-looking string.",
          "Imagine this string gets copied into the <code>username</code> field by the kiosk.",
          "The backend runs: <code>SELECT * FROM users WHERE username = '$username' AND password = '$password'</code>.",
          "With the payload from the QR, this WHERE clause becomes always true and bypasses login."
        ],
        stepsAr: [
          "Ø§Ø¹Ø±Ø¶ ÙˆØ§Ù…Ø³Ø­ ÙƒÙˆØ¯ Ø§Ù„Ù€ QR. Ø³ØªØ±Ù‰ Ù†ØµÙ‹Ø§ ÙŠØ´Ø¨Ù‡ Ø­Ù‚Ù† SQL ÙˆÙ„ÙŠØ³ Ø±Ø§Ø¨Ø·Ù‹Ø§ Ø¹Ø§Ø¯ÙŠÙ‹Ø§.",
          "ØªØ®ÙŠÙ‘Ù„ Ø£Ù† Ù‡Ø°Ø§ Ø§Ù„Ù†Øµ ÙŠÙÙ†Ø³Ø® ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¥Ù„Ù‰ Ø­Ù‚Ù„ <code>username</code> ÙÙŠ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯Ø®ÙˆÙ„.",
          "Ø§Ù„Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯ ÙŠÙ†ÙÙ‘Ø° Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…: <code>SELECT * FROM users WHERE username = '$username' AND password = '$password'</code>.",
          "Ù…Ø¹ Ø§Ù„Ù€ Payload Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù€ QRØŒ Ø´Ø±Ø· WHERE ÙŠØµØ¨Ø­ Ø¯Ø§Ø¦Ù…Ù‹Ø§ ØµØ­ÙŠØ­ØŒ ÙÙŠØªÙ… ØªØ¬Ø§ÙˆØ² ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„."
        ],
        detailsEn: `
          <p>
            <strong>Example backend (PHP, vulnerable):</strong>
          </p>
          <pre><code>
$qr_content = $_POST['qr']; // read from QR scanner
$username   = $qr_content;
$password   = $_POST['password'];

$sql = "SELECT * FROM users
        WHERE username = '$username'
          AND password = '$password'";
          </code></pre>
          <p>
            If the QR content is <code>' OR 1=1 --</code>, the final query becomes:
          </p>
          <pre><code>
SELECT * FROM users
WHERE username = '' OR 1=1 -- '
  AND password = 'anything';
          </code></pre>
          <p>
            The <code>OR 1=1</code> makes the condition always true, and the comment
            <code>--</code> ignores the rest, so the login is trivially bypassed.
          </p>
        `,
        detailsAr: `
          <p>
            <strong>Ù…Ø«Ø§Ù„ Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯ (PHP Ù…Ø¹Ø±Ù‘Ø¶ Ù„Ù„Ø«ØºØ±Ø©):</strong>
          </p>
          <pre><code>
$qr_content = $_POST['qr']; // Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù†Øµ Ù…Ù† Ù…Ø§Ø³Ø­ Ø§Ù„Ù€ QR
$username   = $qr_content;
$password   = $_POST['password'];

$sql = "SELECT * FROM users
        WHERE username = '$username'
          AND password = '$password'";
          </code></pre>
          <p>
            Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù€ QR Ù‡Ùˆ <code>' OR 1=1 --</code> ÙØ³ÙŠØµØ¨Ø­ Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…:
          </p>
          <pre><code>
SELECT * FROM users
WHERE username = '' OR 1=1 -- '
  AND password = 'anything';
          </code></pre>
          <p>
            Ø§Ù„Ø´Ø±Ø· <code>OR 1=1</code> ÙŠØ¬Ø¹Ù„Ù‡ Ø¯Ø§Ø¦Ù…Ù‹Ø§ ØµØ­ÙŠØ­ØŒ ÙˆØ§Ù„ØªØ¹Ù„ÙŠÙ‚ <code>--</code> ÙŠÙ„ØºÙŠ Ø¨Ù‚ÙŠØ© Ø§Ù„Ø¬Ù…Ù„Ø©ØŒ
            ÙˆØ¨Ø°Ù„Ùƒ ÙŠØªÙ… ØªØ¬Ø§ÙˆØ² ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø³Ù‡ÙˆÙ„Ø© ØªØ§Ù…Ø©.
          </p>
        `,
        qrCaptionEn: `
          This QR should contain a <strong>raw SQL payload</strong> such as
          <code>' OR 1=1 --</code> instead of a URL. Treat it as if the kiosk
          copies this string into the username field.
        `,
        qrCaptionAr: `
          Ù‡Ø°Ø§ Ø§Ù„Ù€ QR ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ <strong>Payload SQL Ø®Ø§Ù…</strong> Ù…Ø«Ù„
          <code>' OR 1=1 --</code> Ø¨Ø¯Ù„ Ø±Ø§Ø¨Ø·. ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡ ÙƒØ£Ù† Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠÙ†Ø³Ø®Ù‡ Ø­Ø±ÙÙŠÙ‹Ø§
          Ø¯Ø§Ø®Ù„ Ø®Ø§Ù†Ø© Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….
        `
      },
      2: {
        subEn: "QR encodes a malicious URL with an injected id parameter.",
        subAr: "Ø§Ù„Ù€ QR ÙŠØ­ØªÙˆÙŠ Ø±Ø§Ø¨Ø·Ù‹Ø§ Ù…Ù„ØºÙ‘Ù…Ù‹Ø§ ÙÙŠÙ‡ Ø­Ù‚Ù† Ø¯Ø§Ø®Ù„ Ø¨Ø§Ø±Ø§Ù…ØªØ± id.",
        introEn: `
          This lab shows how a QR code can hold a <strong>weaponized URL</strong> where
          the SQL injection payload is already inside the query string (e.g. in <code>id</code>).
          The system opens whatever URL comes from the QR without validation.
        `,
        introAr: `
          Ù‡Ø°Ø§ Ø§Ù„Ù„Ø§Ø¨ ÙŠÙˆØ¶Ù‘Ø­ ÙƒÙŠÙ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠØ­ØªÙˆÙŠ ÙƒÙˆØ¯ <strong>QR</strong> Ø¹Ù„Ù‰ Ø±Ø§Ø¨Ø·
          <strong>Ù…Ù„ØºÙ‘Ù… Ù…Ø³Ø¨Ù‚Ù‹Ø§</strong> Ø¨Ø­ÙŠØ« ÙŠÙƒÙˆÙ† Ø­Ù‚Ù† SQL Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§ Ø£ØµÙ„Ù‹Ø§ Ø¯Ø§Ø®Ù„
          Ø¨Ø§Ø±Ø§Ù…ØªØ± <code>id</code>ØŒ Ø¨ÙŠÙ†Ù…Ø§ Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø· ÙƒÙ…Ø§ Ù‡Ùˆ Ø¨Ø¯ÙˆÙ† Ø£ÙŠ ØªØ­Ù‚Ù‚ Ø£Ùˆ ÙÙ„ØªØ±Ø©.
        `,
        stepsEn: [
          "Reveal and scan the QR below. This time, you will see a full URL, not just a payload.",
          "Notice that the <code>id</code> parameter inside the URL already contains an injection like <code>7 OR 1=1--</code>.",
          "A vulnerable backend does: <code>$id = $_GET['id']; $q = \"SELECT * FROM users WHERE id = $id\";</code>",
          "Because the QR itself is malicious, scanning it is enough to trigger SQL injection."
        ],
        stepsAr: [
          "Ø§Ø¹Ø±Ø¶ ÙˆØ§Ù…Ø³Ø­ ÙƒÙˆØ¯ Ø§Ù„Ù€ QR. Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø±Ø© Ø³ØªØ±Ù‰ Ø±Ø§Ø¨Ø·Ù‹Ø§ ÙƒØ§Ù…Ù„Ù‹Ø§ØŒ ÙˆÙ„ÙŠØ³ Ù…Ø¬Ø±Ø¯ Ù†Øµ.",
          "Ø§Ù†ØªØ¨Ù‡ Ø¥Ù„Ù‰ Ø£Ù† Ø¨Ø§Ø±Ø§Ù…ØªØ± <code>id</code> ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø· ÙŠØ­ØªÙˆÙŠ Ù…Ù† Ø§Ù„Ø£ØµÙ„ Ø¹Ù„Ù‰ Ø­Ù‚Ù† Ù…Ø«Ù„ <code>7 OR 1=1--</code>.",
          "Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯ Ù…Ø¹Ø±Ù‘Ø¶ Ù„Ù„Ø«ØºØ±Ø© ÙŠØ¹Ù…Ù„ Ù…Ø«Ù„: <code>$id = $_GET['id']; $q = \"SELECT * FROM users WHERE id = $id\";</code>.",
          "Ø¨Ù…Ø§ Ø£Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ù†ÙØ³Ù‡ Ù…Ù„ØºÙ‘Ù… Ø¯Ø§Ø®Ù„ Ø§Ù„Ù€ QRØŒ Ù…Ø¬Ø±Ø¯ Ù…Ø³Ø­Ù‡ ÙˆÙØªØ­Ù‡ ÙŠÙƒÙÙŠ Ù„ØªÙ†ÙÙŠØ° SQLi."
        ],
        detailsEn: `
          <p><strong>Example vulnerable backend:</strong></p>
          <pre><code>
$id = $_GET['id']; // from QR URL: ?id=7 OR 1=1--
$sql = "SELECT * FROM users WHERE id = $id";
          </code></pre>
          <p>
            If the QR encodes:
          </p>
          <pre><code>
http://lab.local/profile.php?id=7 OR 1=1--
          </code></pre>
          <p>
            the final SQL will be:
          </p>
          <pre><code>
SELECT * FROM users WHERE id = 7 OR 1=1--;
          </code></pre>
          <p>
            This returns all rows instead of a single profile.
          </p>
        `,
        detailsAr: `
          <p><strong>Ù…Ø«Ø§Ù„ Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯ Ù…Ø¹Ø±Ù‘Ø¶:</strong></p>
          <pre><code>
$id = $_GET['id']; // Ø¬Ø§ÙŠ Ù…Ù† Ø±Ø§Ø¨Ø· Ø¯Ø§Ø®Ù„ QR: ?id=7 OR 1=1--
$sql = "SELECT * FROM users WHERE id = $id";
          </code></pre>
          <p>
            Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù€ QR ÙŠØ­ØªÙˆÙŠ Ø§Ù„Ø±Ø§Ø¨Ø·:
          </p>
          <pre><code>
http://lab.local/profile.php?id=7 OR 1=1--
          </code></pre>
          <p>
            ÙŠØµØ¨Ø­ Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:
          </p>
          <pre><code>
SELECT * FROM users WHERE id = 7 OR 1=1--;
          </code></pre>
          <p>
            ÙÙŠØ±Ø¬Ø¹ ÙƒÙ„ Ø§Ù„ØµÙÙˆÙ Ø¨Ø¯Ù„ Ø¨Ø±ÙˆÙØ§ÙŠÙ„ ÙˆØ§Ø­Ø¯ ÙÙ‚Ø·ØŒ ÙˆÙ‡Ø°Ø§ Ù…Ø«Ø§Ù„ ÙˆØ§Ø¶Ø­ Ø¹Ù„Ù‰ SQLi Ø¹Ø¨Ø± Ø±Ø§Ø¨Ø· Ù…Ù„ØºÙ‘Ù… Ø¯Ø§Ø®Ù„ QR.
          </p>
        `,
        qrCaptionEn: `
          This QR should contain a <strong>full URL</strong> such as
          <code>http://lab.local/profile.php?id=7 OR 1=1--</code>.  
          The injection lives inside the <code>id</code> parameter.
        `,
        qrCaptionAr: `
          Ù‡Ø°Ø§ Ø§Ù„Ù€ QR ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ <strong>Ø±Ø§Ø¨Ø· ÙƒØ§Ù…Ù„</strong> Ù…Ø«Ù„:
          <code>http://lab.local/profile.php?id=7 OR 1=1--</code>.  
          Ø­Ù‚Ù† SQL Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø®Ù„ Ø¨Ø§Ø±Ø§Ù…ØªØ± <code>id</code> Ù†ÙØ³Ù‡.
        `
      },
      3: {
        subEn: "QR stores a Base64-encoded SQL payload decoded by the backend.",
        subAr: "Ø§Ù„Ù€ QR ÙŠØ®Ø²Ù‘Ù† Payload Ø­Ù‚Ù† SQL Ø¨ØµÙŠØºØ© Base64 ÙˆÙŠØªÙ… ÙÙƒÙ‘Ù‡ ÙÙŠ Ø§Ù„Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯.",
        introEn: `
          Here the system thinks it is â€œsaferâ€ by taking a Base64 string from a QR code,
          decoding it, and then using the result inside a SQL query. Encoding does not
          equal security.
        `,
        introAr: `
          ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù„Ø§Ø¨ ÙŠØ¹ØªÙ‚Ø¯ Ø§Ù„Ù†Ø¸Ø§Ù… Ø£Ù†Ù‡ Ø£ØµØ¨Ø­ â€œØ£ÙƒØ«Ø± Ø£Ù…Ø§Ù†Ù‹Ø§â€ Ù„Ø£Ù†Ù‡ ÙŠØ£Ø®Ø° Ù†ØµÙ‹Ø§
          Ø¨ØµÙŠØºØ© <strong>Base64</strong> Ù…Ù† Ø§Ù„Ù€ QRØŒ ÙŠÙÙƒÙ‘Ù‡ØŒ Ø«Ù… ÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ø§ØªØ¬ Ø¯Ø§Ø®Ù„ Ø§Ø³ØªØ¹Ù„Ø§Ù… SQL.
          Ù„ÙƒÙ† Ø§Ù„ØªØ±Ù…ÙŠØ² <strong>Ù„Ø§ ÙŠØ¹Ù†ÙŠ</strong> Ø£Ù…Ø§Ù†.
        `,
        stepsEn: [
          "Reveal and scan the QR code: you will see what looks like random Base64, not SQL.",
          "Send that value as <code>code=...</code> to a vulnerable endpoint.",
          "The backend does <code>$decoded = base64_decode($_GET['code']);</code> and then injects it into SQL.",
          "The decoded value is actually a SQL injection payload such as <code>' OR 1=1 --</code>."
        ],
        stepsAr: [
          "Ø§Ø¹Ø±Ø¶ ÙˆØ§Ù…Ø³Ø­ ÙƒÙˆØ¯ Ø§Ù„Ù€ QRØ› Ø³ØªØ±Ù‰ Ù†ØµÙ‹Ø§ Ù…Ø´ÙÙ‘Ø±Ù‹Ø§ Ø¨Ù€ Base64 ÙŠØ¨Ø¯Ùˆ Ø¹Ø´ÙˆØ§Ø¦ÙŠÙ‹Ø§.",
          "ØªØ®ÙŠÙ‘Ù„ Ø£Ù†Ùƒ ØªØ±Ø³Ù„Ù‡ ÙƒÙ‚ÙŠÙ…Ø© ÙÙŠ Ø¨Ø§Ø±Ø§Ù…ØªØ± <code>code=...</code> Ø¥Ù„Ù‰ Ø³ÙƒØ±Ø¨Øª Ù…Ø¹Ø±Ù‘Ø¶.",
          "Ø§Ù„Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯ ÙŠÙ†ÙÙ‘Ø°: <code>$decoded = base64_decode($_GET['code']);</code> Ø«Ù… ÙŠØ¶Ø¹ Ø§Ù„Ù†Ø§ØªØ¬ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¯Ø§Ø®Ù„ SQL.",
          "Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¨Ø¹Ø¯ ÙÙƒ Base64 ØªÙƒÙˆÙ† ÙØ¹Ù„ÙŠÙ‹Ø§ Payload Ù…Ø«Ù„ <code>' OR 1=1 --</code>."
        ],
        detailsEn: `
          <p><strong>Example vulnerable backend:</strong></p>
          <pre><code>
$raw     = $_GET['code'];          // from QR: "JyBPUiAxPTEgLS0="
$decoded = base64_decode($raw);    // "' OR 1=1 --"

$sql = "SELECT * FROM users WHERE username = '$decoded'";
          </code></pre>
          <p>
            If the QR holds <code>JyBPUiAxPTEgLS0=</code>, that decodes to:
            <code>' OR 1=1 --</code>, which turns the query into a classic injection.
          </p>
        `,
        detailsAr: `
          <p><strong>Ù…Ø«Ø§Ù„ Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯ Ù…Ø¹Ø±Ù‘Ø¶:</strong></p>
          <pre><code>
$raw     = $_GET['code'];          // Ø¬Ø§ÙŠ Ù…Ù† QR: "JyBPUiAxPTEgLS0="
$decoded = base64_decode($raw);    // Ø§Ù„Ù†Ø§ØªØ¬: ' OR 1=1 --

$sql = "SELECT * FROM users WHERE username = '$decoded'";
          </code></pre>
          <p>
            Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù€ QR ÙŠØ­ØªÙˆÙŠ Ø§Ù„Ù†Øµ <code>JyBPUiAxPTEgLS0=</code>ØŒ ÙØ¥Ù† ÙÙƒ Base64 ÙŠÙ†ØªØ¬:
            <code>' OR 1=1 --</code>ØŒ ÙÙŠØªØ­ÙˆÙ‘Ù„ Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¥Ù„Ù‰ Ø­Ù‚Ù† SQL ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ.
          </p>
        `,
        qrCaptionEn: `
          This QR should contain a <strong>Base64 string</strong> like
          <code>JyBPUiAxPTEgLS0=</code>, which decodes to <code>' OR 1=1 --</code>.
          The backend decodes it and gets injected.
        `,
        qrCaptionAr: `
          Ù‡Ø°Ø§ Ø§Ù„Ù€ QR ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ <strong>Ù†Øµ Base64</strong> Ù…Ø«Ù„
          <code>JyBPUiAxPTEgLS0=</code>ØŒ ÙˆØ§Ù„Ø°ÙŠ ÙŠÙÙƒ Ø¥Ù„Ù‰ <code>' OR 1=1 --</code>.
          Ø§Ù„Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯ ÙŠÙÙƒÙ‘Ù‡ Ø«Ù… ÙŠØªØ¹Ø±Ù‘Ø¶ Ù„Ø­Ù‚Ù† SQL.
        `
      }
    };

    const id = getIdFromUrl();
    const mainEl = document.getElementById("main");

    if (!id) {
      mainEl.innerHTML = `
        <section class="error-card">
          <h2 class="error-title">Invalid or missing challenge ID</h2>
          <p class="error-text">
            This page expects a URL like <code>?id=7</code>.<br/>
            Use a QR from the main ideas page or open a card and click "Start challenge".
          </p>
          <a class="error-link" href="index.html">â† Go back to the ideas library</a>
        </section>
      `;
    } else {
      const padded = String(id).padStart(2, "0");
      const level = getLevel(id);
      const data = challengeData[id];

      // default / generic text for IDs without custom data
      const genericIntroEn = `
        This challenge starts from a <strong>QR code</strong> and ends with a
        <strong>SQL injection</strong> on a training endpoint. Use this page as a launcher:
        reveal the QR, scan it on your phone, then attack the URL or data you get using
        SQLi techniques that match idea #${id} from the main library.
      `;
      const genericIntroAr = `
        Ù‡Ø°Ø§ Ø§Ù„ØªØ­Ø¯Ù‘ÙŠ ÙŠØ¨Ø¯Ø£ Ù…Ù† <strong>ÙƒÙˆØ¯ QR</strong> ÙˆÙŠÙ†ØªÙ‡ÙŠ Ø¨Ù€
        <strong>SQL Injection</strong> Ø¹Ù„Ù‰ Ø³ÙƒØ±Ø¨Øª ØªØ¯Ø±ÙŠØ¨ÙŠ. Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© ÙƒÙ†Ù‚Ø·Ø©
        Ø§Ù†Ø·Ù„Ø§Ù‚: Ø§Ø¹Ø±Ø¶ Ø§Ù„Ù€ QRØŒ Ø§Ù…Ø³Ø­Ù‡ Ø¨Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ØŒ Ø«Ù… Ø§Ø³ØªÙ‡Ø¯Ù Ø§Ù„Ø±Ø§Ø¨Ø· Ø£Ùˆ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ø§ØªØ¬Ø©
        Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙ‚Ù†ÙŠØ§Øª SQLi Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„ÙÙƒØ±Ø© Ø±Ù‚Ù… <strong>${id}</strong> Ù…Ù† Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©.
      `;

      const genericStepsEn = [
        "Reveal the QR code for this challenge.",
        "Scan it with your phone and open the resulting URL or data.",
        "Identify which parameter / field flows into SQL on the backend.",
        "Apply SQL injection techniques as suggested by the idea card."
      ];
      const genericStepsAr = [
        "Ø§Ø¹Ø±Ø¶ ÙƒÙˆØ¯ Ø§Ù„Ù€ QR Ø§Ù„Ø®Ø§Øµ Ø¨Ù‡Ø°Ø§ Ø§Ù„ØªØ­Ø¯Ù‘ÙŠ.",
        "Ø§Ù…Ø³Ø­Ù‡ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¬ÙˆÙ‘Ø§Ù„Ùƒ ÙˆØ§ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø· Ø£Ùˆ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ø§ØªØ¬Ø©.",
        "Ø­Ø¯Ù‘Ø¯ Ø£ÙŠ Ø¨Ø§Ø±Ø§Ù…ØªØ± Ø£Ùˆ Ø­Ù‚Ù„ ÙŠØ¯Ø®Ù„ ÙÙŠ Ø§Ø³ØªØ¹Ù„Ø§Ù… SQL ÙÙŠ Ø§Ù„Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯.",
        "Ø·Ø¨Ù‘Ù‚ ØªÙ‚Ù†ÙŠØ§Øª SQLi ÙƒÙ…Ø§ Ù‡Ùˆ Ù…ÙˆØ¶Ù‘Ø­ ÙÙŠ ÙƒØ§Ø±Ø¯ Ø§Ù„ÙÙƒØ±Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù…."
      ];

      const introEn = data ? data.introEn : genericIntroEn;
      const introAr = data ? data.introAr : genericIntroAr;
      const stepsEn = data ? data.stepsEn : genericStepsEn;
      const stepsAr = data ? data.stepsAr : genericStepsAr;
      const subEn = data ? data.subEn : "";
      const subAr = data ? data.subAr : "";
      const detailsEn = data ? data.detailsEn : `
        <p>
          Use this lab to practice reading data flow from <strong>QR â†’ input â†’ SQL query</strong>.
          The exact vulnerability and exploitation style should match the description
          on idea card #${id} in the main page (e.g. ID-based SQLi, search-based SQLi, blind SQLi, etc.).
        </p>
      `;
      const detailsAr = data ? data.detailsAr : `
        <p>
          Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„Ù„Ø§Ø¨ Ù„Ù„ØªØ¯Ø±Ù‘Ø¨ Ø¹Ù„Ù‰ ØªØªØ¨Ù‘Ø¹ ØªØ¯ÙÙ‘Ù‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù†
          <strong>QR â†’ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… â†’ Ø§Ø³ØªØ¹Ù„Ø§Ù… SQL</strong>.
          Ù†ÙˆØ¹ Ø§Ù„Ø«ØºØ±Ø© ÙˆØ·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªØºÙ„Ø§Ù„ ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªØ·Ø§Ø¨Ù‚Ø§ Ù…Ø¹ ÙˆØµÙ Ø§Ù„ÙÙƒØ±Ø© Ø±Ù‚Ù… <strong>${id}</strong>
          ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Ù…Ø«Ù„ SQLi Ø¹Ù„Ù‰ <code>id</code>ØŒ Ø£Ùˆ Ø¹Ù„Ù‰ Ø®Ø§Ù†Ø© Ø¨Ø­Ø«ØŒ Ø£Ùˆ Blind SQLiØŒ Ø¥Ù„Ø®).
        </p>
      `;
      const qrCaptionEn = data
        ? data.qrCaptionEn
        : `
          Scan this QR with your phone to open the <strong>lab entry point</strong>
          or obtain the raw data that flows into the backend SQL query.
        `;
      const qrCaptionAr = data
        ? data.qrCaptionAr
        : `
          Ø§Ù…Ø³Ø­ Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ø¨Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ <strong>Ù†Ù‚Ø·Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù‘Ø§Ø¨</strong>
          Ø£Ùˆ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§Ù… Ø§Ù„ØªÙŠ ØªÙØ³ØªØ®Ø¯Ù… Ø¯Ø§Ø®Ù„ Ø§Ø³ØªØ¹Ù„Ø§Ù… SQL ÙÙŠ Ø§Ù„Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯.
        `;

      mainEl.innerHTML = `
        <section class="card">
          <div class="card-inner">
            <div class="badge-row">
              <div class="badge badge-level-${level.key}">
                <span class="badge-dot"></span>
                ${level.label} Â· Challenge #${id}
              </div>
              <div class="badge">
                <span class="badge-dot" style="background:#38bdf8;"></span>
                QR + SQLi lab
              </div>
            </div>

            <h2>Challenge #${id} â€” QR + SQL Injection</h2>
            <div class="slug">Linked to idea card #${id} from the main QR + SQLi ideas library.</div>

            ${subEn ? `<div class="sub-tag">${subEn}</div>` : ""}
            ${subAr ? `<div class="sub-tag-ar">${subAr}</div>` : ""}

            <p class="intro">
              ${introEn}
            </p>
            <p class="intro-ar">
              ${introAr}
            </p>

            <div class="steps">
              <strong>How to play (EN):</strong>
              <ol>
                ${stepsEn.map(s => `<li>${s}</li>`).join("")}
              </ol>
            </div>
            <div class="steps-ar">
              <strong>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù„Ø¹Ø¨ (AR):</strong><br/>
              ${stepsAr.map(s => `â€¢ ${s}`).join("<br/>")}
            </div>

            <button class="reveal-btn" id="revealBtn">
              <span class="icon">ğŸ‘ï¸</span>
              Click to view QR &nbsp;|&nbsp; Ø§Ø¶ØºØ· Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù€ QR
            </button>

            <div class="qr-wrapper" id="qrBox">
              <img src="qr/QR_${padded}.png" alt="QR code for challenge ${id}" />
              <div class="qr-caption">
                ${qrCaptionEn}<br/>
                ${qrCaptionAr}
              </div>
              <div class="hint-tap">
                After you scan and open the URL / data on your phone, tap this QR box again
                here to show extra hints ğŸ‘‡  
                Ø¨Ø¹Ø¯ Ù…Ø§ ØªÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø· Ø£Ùˆ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù„Ù‰ Ø¬ÙˆÙ‘Ø§Ù„ÙƒØŒ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø±Ø¨Ù‘Ø¹ Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ©
                Ù„Ø¹Ø±Ø¶ ØªÙ„Ù…ÙŠØ­Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©.
              </div>
            </div>

            <div class="details" id="details">
              ${detailsEn}
              <div class="details-ar">
                ${detailsAr}
              </div>
              <button class="start-btn" type="button">
                Iâ€™ve scanned the QR â€” start hacking ğŸ’»
              </button>
              <p class="note">
                âš  Training-only: these challenges are meant for <strong>education and CTF labs</strong>,
                not for testing real systems without proper permission.
              </p>
            </div>
          </div>
        </section>
      `;

      const qrBox = document.getElementById("qrBox");
      const details = document.getElementById("details");
      const revealBtn = document.getElementById("revealBtn");

      revealBtn.addEventListener("click", () => {
        qrBox.classList.add("visible");
        revealBtn.style.display = "none";
      });

      qrBox.addEventListener("click", () => {
        details.classList.toggle("visible");
      });
    }
  </script>
</body>
</html>
